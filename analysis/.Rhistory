responseinits
responseinitsfinal
28*2
56+6
length(responseinits)
28*3
responseinitsfinal
length(responseinitsfinal)
length(filter)
filter
responseinits_filter
length(responseinits_filter)
responseinits
length(responseinits)
source('betting-sequence-model.R')
source('betting-sequence-model.R')
source('betting-sequence-model.R')
reload()
source('betting-sequence-model.R')
reload()
source('betting-sequence-model.R')
reload()
source('betting-sequence-model.R')
reload()
source('betting-sequence-model.R')
reload()
source('betting-sequence-model.R')
source('betting-sequence-model.R')
fit.dmmR.op = fit(dmmR.op)
save.image()
responseinits
source('betting-sequence-model.R')
reload()
source('betting-sequence-model.R')
Sys.sleep(100)
?Sys.sleep
Sys.sleep(.1)
Sys.sleep(.2)
reload()
source('betting-sequence-model.R')
reload()
source('betting-sequence-model.R')
reload()
source('betting-sequence-model.R')
reload()
source('betting-sequence-model.R')
source('betting-sequence-model.R')
ls()
fit.dmmR
fit.dmmR@response
fit.dmmR@dens
head(fit.dmmR@dens)
dime(fit.dmmR@dens)
dims(fit.dmmR@dens)
dim(fit.dmmR@dens)
dim(fit.dmmR@dens[1])
fit.dmmR@dens[1]
fit.dmmR@dens[2]
fit.dmmR@dens[1:6]
sum(fit.dmmR@dens[1:6])
sum(fit.dmmR@dens[6:12])
sum(fit.dmmR@dens[7:12])
sum(fit.dmmR@dens[13:18])
source('betting-sequence-model.R')
rm(pdataAK)
source('betting-sequence-model.R')
source('betting-sequence-model.R')
source('betting-sequence-model.R')
reload)(
reload()
source('betting-sequence-model.R')
ls()
rm(pdataAK)
source('betting-sequence-model.R')
head(pdataAK)
length(pdataAK)
pdataAK
nrow(pdataAK)
unique(pdataAK$V2)
ls()
rm(pdataAK)
source('betting-sequence-model.R')
source('betting-sequence-model.R')
source('betting-sequence-model.R')
source('betting-sequence-model.R')
dmm = depmix(list(V5~1, V6~1, V8~1)
, data=temp_ordered
, nstates=1
, ntimes=iseq[,3]
, family = list(multinomial(), multinomial(), multinomial()))
dmm = depmix(list(V5~1, V6~1, V8~1)
, data=temp_ordered
, nstates=1
, ntimes=iseq[,3]
, family = list(multinomial(), multinomial(), multinomial()))
temp = pdata[pdata$V2 %in% hand_list, ]
# Aggregate counts so we know what actions are part of an independant series
# We don't want the model to treat this as a single time series because each new hand play is independant
iseq = aggregate(V2 ~ V1 + V4, temp, length)
iseq = iseq[order(iseq$V1, iseq$V4), ]
# Ensure the data is ordered properly by handid, playerid, and actionnumber
temp_ordered = temp[order(temp$V1, temp$V4, temp$V7), ]
hand_list=c('AKo')
temp = pdata[pdata$V2 %in% hand_list, ]
# Aggregate counts so we know what actions are part of an independant series
# We don't want the model to treat this as a single time series because each new hand play is independant
iseq = aggregate(V2 ~ V1 + V4, temp, length)
iseq = iseq[order(iseq$V1, iseq$V4), ]
# Ensure the data is ordered properly by handid, playerid, and actionnumber
temp_ordered = temp[order(temp$V1, temp$V4, temp$V7), ]
dmm = depmix(list(V5~1, V6~1, V8~1)
, data=temp_ordered
, nstates=1
, ntimes=iseq[,3]
, family = list(multinomial(), multinomial(), multinomial()))
fit.dmm = fit(dmm)
dmm
dmm = depmix(list(V5~1, V6~1, V8~1)
, data=temp_ordered
, nstates=1
, ntimes=iseq[,3]
, family = list(multinomial("identity"), multinomial("identity"), multinomial("identity")))
fit.dmm = fit(dmm)
getpars(dmm)
getpars(dmm)
fit.dmm = fit(dmm)
ls()
dmm = depmix(list(V5~1, V6~1, V8~1), data=temp_ordered, nstates=2, ntimes=iseq[,3], family = list(multino\
mial("identity"), multinomial("identity"), multinomial("identity")))
dmm = depmix(list(V5~1, V6~1, V8~1), data=temp_ordered, nstates=2, ntimes=iseq[,3], family = list(multino\
dmm = depmix(list(V5~1, V6~1, V8~1), data=temp_ordered, nstates=2, ntimes=iseq[,3], family = list(multino 
mial("identity"), multinomial("identity"), multinomial("identity")))
dmm = depmix(list(V5~1, V6~1, V8~1)
, data=temp_ordered
, nstates=2
, ntimes=iseq[,3]
, family = list(multinomial("identity"), multinomial("identity"), multinomial("identity")))
head(temp_ordered)
dmm = depmix(list(V5~1, V6~1, V8~1)
, data=temp_ordered
, nstates=2
, ntimes=iseq[,3]
, family = list(multinomial(), multinomial(), multinomial()))
fit.dmm = fit(dmm)
dmm1 = depmix(list(V5~1, V6~1, V8~1)
, data=temp_ordered
, nstates=1
, ntimes=iseq[,3]
, family = list(multinomial(), multinomial(), multinomial()))
fit.dmm1 = fit(dmm1)
dmm1 = depmix(list(V5~1, V6~1, V8~1)
, data=temp_ordered
, nstates=2
, ntimes=iseq[,3]
, family = list(multinomial(), multinomial(), multinomial()))
dmm2 = depmix(list(V5~1, V6~1, V8~1)
, data=temp_ordered
, nstates=2
, ntimes=iseq[,3]
, family = list(multinomial(), multinomial(), multinomial()))
fit.dmm2 = fit(dmm2)
head(fit.dmm2@posterior)
eval.fit = cbind(temp_ordered, fit.dmm2@posterior)
head(eval.fit)
aggregate(V1 ~ state + V2)
aggregate(eval.fit, V1 ~ state + V2, length)
aggregate(V1 ~ state + V2, eval.fit, length)
fit.dmm2@response
fit.dmm2@transition
getpars(getmodel(fit.dmm2, state=1))
fit.dmm2@response
length(getpars(getmodel(fit.dmm2, state=1)))
length(getpars(getmodel(fit.dmm2, state=1, number=1)))
length(getpars(getmodel(fit.dmm2, state=1, number=2)))
length(getpars(getmodel(fit.dmm2, state=1, number=3)))
length(getpars(getmodel(fit.dmm2, state=1, number=4)))
getpars(fit.dmm2)
fit.dmm2@transition
fit.dmm2@trDens
pars = getpars(fit.dmm2)
head(pdatasampled)
responseinits = pars[7:npar(fit.dmm2)]
responseinits
flags = c(unlist(getpars(fit.dmm2, "fixed")))
flags
pars
7+14
flags = c(unlist(getpars(fit.dmmR2, "fixed")))
responseinitsfinal = c(rep(0,6), pars[7:21], rep(0, 14))
length(responseinitsfinal) == length(pars)
length(responseinitsfinal)
length(pars)
responseinitsfinal = c(rep(0,6), pars[7:21], rep(0, 13))
responseinitsfinal
responseinitsfinal = c(rep(0,6), pars[7:20], rep(0, 14))
responseinitsfinal
length(pars)
length(responseinitsfinal)
pars[3:6]
pars[1:2]
fit.dmm2@transition
fit.dmm2@trDens
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal, trstart=pars[3:6], instart=pars[1:2], family=list(multinomial(), multinomial(), multinomial()))
getpars(fit.dmm2)
length(getpars(fit.dmm2))
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal[7:], trstart=pars[3:6], instart=pars[1:2], family=list(multinomial(), multinomial(), multinomial()))
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal[7:28], trstart=pars[3:6], instart=pars[1:2], family=list(multinomial(), multinomial(), multinomial()))
responseinitsfinal[7:length(responseinitsfinal)]
length(responseinitsfinal[7:length(responseinitsfinal)])
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal[7:length(responseinitsfinal)], trstart=pars[3:6], instart=pars[1:2], family=list(multinomial(), multinomial(), multinomial()))
responseinitsfinal
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal[7:length(responseinitsfinal)], trstart=c(1,0,0,1), instart=c(.5, .5), family=list(multinomial(), multinomial(), multinomial()))
responseinitsfinal = c(runif(6), pars[7:20], runif(14))
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal[7:length(responseinitsfinal)], trstart=c(1,0,0,1), instart=c(.5, .5), family=list(multinomial(), multinomial(), multinomial()))
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal[7:length(responseinitsfinal)], trstart=c(1,0,.5,.5), instart=c(.5, .5), family=list(multinomial(), multinomial(), multinomial()))
responseinitsfinal
responseinitsfinal[7:length(responseinitsfinal)]
responseinitsfinal = responseinitsfinal[7:length(responseinitsfinal)]
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal, trstart=c(1,0,.5,.5), instart=c(.5, .5), family=list(multinomial(), multinomial(), multinomial()))
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=abs(responseinitsfinal), trstart=c(1,0,.5,.5), instart=c(.5, .5), family=list(multinomial(), multinomial(), multinomial()))
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=abs(responseinitsfinal), trstart=c(1,0,.5,.5), instart=c(.5, .5), family=list(multinomial(), multinomial(), multinomial()))
responseinits
replace(0.0, responseinitsfinal, 1.0)
responseinits[1]
responseinits[1] = 1.0
responseinits[1]
responseinitsfinal[1]
responseinitsfinal[1] = 1.0
responseinitsfinal
responseinitsfinal[8] = 1.0
responseinitsfinal[12] = 1.0
responseinitsfinal
abs(responseinitsfinal)
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=abs(responseinitsfinal), trstart=c(1,0,.5,.5), instart=c(.5, .5), family=list(multinomial(), multinomial(), multinomial()))
responseinitsfinal
responseinits
responseinits[1] = 0.0
responseinits
responseinitsfinal = responseinits[7:length(responseinits)]
length(responseinitsfinal)
responseinits = pars[7:npar(fit.dmm2)]
responseinits
responseinits
length(responseinits)
exp(responseinits) / 1+exp(responseinits)
responseinitsfinal = exp(responseinits) / 1+exp(responseinits)
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal, trstart=c(1,0,.5,.5), instart=c(.5, .5), family=list(multinomial(), multinomial(), multinomial()))
fit.dmm2.op = fit(dmm2.op)
eval.dmm2.op = cbind(pdatasampled, fit.dmm2.op@posterior)
head(eval.dmm2.op
)
aggregate(V1 ~ state + V2, eval.dmm2.op, length)
save.image()
savehistory()
getwd()
save.image()
aggregate(. ~ state + V2, eval.dmm2.op, length)
aggregate(~ state + V2, eval.dmm2.op, length)
aggregate(V1 ~ state + V2, eval.dmm2.op, length)
getpars(dmm2.op)
responseinits
length(responseinits)
length(responseinits[1:14])
fit.dmm2.op = fit(dmm2.op, equal = c(rep(1, 6), responseinits[1:14], rep(1,14)))
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal, trstart=c(1,0,.5,.5), instart=c(.1, .9), family=list(multinomial(), multinomial(), multinomial()))
fit.dmm2.op = fit(dmm2.op, equal = c(rep(1, 6), responseinits[1:14], rep(1,14)))
fit.dmm2.op = fit(dmm2.op, equal = c(rep(1, 6), rep(c(0,1), 7), rep(1,14)))
fit.dmm2.op = fit(dmm2.op, equal = c(rep(1, 6), rep(c(0,1), 7), rep(1,14)))
fit.dmm2.op = fit(dmm2.op)
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal, trstart=c(.9,.1,.5,.5), instart=c(.3, .7), family=list(multinomial(), multinomial(), multinomial()))
fit.dmm2.op = fit(dmm2.op)
eval.dmm2.op = cbind(pdatasampled, fit.dmm2.op@posterior)
aggregate(V1 ~ state + V2, eval.dmm2.op, length)
fit.dmm2@trDens
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal, trstart=c(.5,.5,.5,.5), instart=c(.5, .5), family=list(multinomial(), multinomial(), multinomial()))
fit.dmm2.op = fit(dmm2.op)
fit.dmm2.op = fit(dmm2.op)
eval.dmm2.op = cbind(pdatasampled, fit.dmm2.op@posterior)
aggregate(V1 ~ state + V2, eval.dmm2.op, length)
getpars(fit.dmm2.op)
fit.dmm2.op@response
tail(getpars(fit.dmm2.op))
tail(getpars(fit.dmm2.op), n=14)
fit.dmm2.op@response
tail(getpars(fit.dmm2.op), n=14)
responseinitsfinal
responseinits
responseinitsfinal[15:28]
responseinitsfinal[15:28] = runif(14)
responseinitsfinal
dmm2.op = depmix(list(V5~1, V6~1, V8~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal, trstart=pars[3:6], instart=pars[1:2], family=list(multinomial(), multinomial(), multinomial()))
fit.dmm2.op = fit(dmm2.op)
head(pdatasampled)
dmm2.op = depmix(list(V5~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal, trstart=pars[3:6], instart=pars[1:2], transition = ~V6 + V8, family=list(multinomial(), multinomial(), multinomial()))
dmm2.op = depmix(list(V5~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal, trstart=pars[3:6], instart=pars[1:2], transition = ~V6 + V8, family=list(multinomial()))
pdataAK
AK
dmm2.op = depmix(list(V5~1), data=pdatasampled, nstates=2, respstart=responseinitsfinal[1:14], trstart=pars[3:6], instart=pars[1:2], transition = ~V6 + V8, family=list(multinomial()))
dmm2.op = depmix(list(V5~1), data=pdatasampled, nstates=2, transition = ~V6 + V8, family=list(multinomial()))
fit.dmm2.op = fit(dmm2.op)
eval.dmm2.op = cbind(pdatasampled, fit.dmm2.op@posterior)
aggregate(V1 ~ state + V2, eval.dmm2.op, length)
head(pdata_sample)
source('betting-sequence-model.R')
AK = sthmm(hand_list=c('AKo'))
AKss = sthmm(hand_list=c('AKo'), model=list(V5~1, V6~1, V8~1), numstates=1, fam=list(rep(multinomial("identity"), 3)))
rep(multinomial(), 3)
AKss = sthmm(hand_list=c('AKo'), model=list(V5~1, V6~1, V8~1), numstates=1, fam=list(multinomial("identity"), multinomial("identity"), multinomial("identity")))
AK
names(AK)
source('betting-sequence-model.R')
AK = sthmm(hand_list=c('AKo'))
names(AK)
source('betting-sequence-model.R')
AK = sthmm(hand_list=c('AKo'))
AK[4]
names(AK)
source('betting-sequence-model.R')
AK = sthmm(hand_list=c('AKo'))
names(AK)
AK$eval.matrix
head(temp_ordered)
rm(temp_ordered)
head(temp)
rm(temp)
ls()
AK = sthmm(hand_list=c('AKo'))
names(AK)
AK = sthmm(hand_list=c('AKo'))
source("betting-sequence-model.R")
AK$eval.matrix
head(AK$eval.dataset)
unique(AK$eval.dataset$V2)
source("betting-sequence-model.R")
AK = sthmm(hand_list=c('AKo'))
AK$
eval.matrix
AK$fit.dmm@response
summary(fit.dmmR2)
summary(AK$fit.dmm)
summary(AK$fit.dmm@response)
AK$fit.dmm@response
AK$fit.dmm@response[1]
getpars(getmodel(AK$fit.dmm@reponse, state=1, number=1))
getpars(getmodel(AK$fit.dmm, state=1, number=1))
getpars(getmodel(AK$fit.dmm, state=1, number=2))
getpars(getmodel(AK$fit.dmm, state=1, number=3))
unique(AK$eval.dataset$V5)
unique(AK$eval.dataset$V6)
unique(AK$eval.dataset$V8)
getpars(AK$fit.dmm)
getpars(AK$fit.dmm)[7:14]
getpars(AK$fit.dmm)[7:21]
getpars(AK$fit.dmm)[7:20]
getpars(fit.dmmR2)
getpars(fit.dmmR)
AKr = sthmm(hand_list=c('AKo'), model=list(V2~V5, V2~V6, V2~V8), numstates=2, fam=list(multinomial(), multinomial(), multinomial()))
AKr = sthmm(hand_list=c('AKo', '27o'), model=list(V2~V5, V2~V6, V2~V8), numstates=2, fam=list(multinomial(), multinomial(), multinomial()))
AKr$eval.matrix
unique(pdata$V2)
AKr10 = sthmm(hand_list=c('AKo', '27o', '55o', '5Ao'), model=list(V2~V5, V2~V6, V2~V8), numstates=2, fam=list(multinomial(), multinomial(), multinomial()))
AKr$eval.matrix
save.image()
savehistory()
sthmm
ls()
sample(unique(pdata$V2), 10)
AKr10 = sthmm(hand_list=c('AKo', sample(unique(pdata$V2), 9)), model=list(V2~V5, V2~V6, V2~V8), numstates=2, fam=list(multinomial(), multinomial(), multinomial()))
library(depmixS4)
AKr10 = sthmm(hand_list=c('AKo', sample(unique(pdata$V2), 9)), model=list(V2~V5, V2~V6, V2~V8), numstates=2, fam=list(multinomial(), multinomial(), multinomial()))
c('AKo', sample(unique(pdata$V2), 9)
)
sample(unique(pdata$V2), 10)
unlist(sample(unique(pdata$V2), 10))
as.character(unlist(sample(unique(pdata$V2), 10)))
as.character(sample(unique(pdata$V2), 10))
AKr10 = sthmm(hand_list=c('AKo', as.character(sample(unique(pdata$V2), 9))), model=list(V2~V5, V2~V6, V2~V8), numstates=2, fam=list(multinomial(), multinomial(), multinomial()))
AKr10$eval.matrix
save.image()
ls()
AKr$fit.dmm@response
pars = getpars(AKr$fit.dmm)
tail(pars)
pars[seq(4,npar(AKr$fit.dmm),4)]
pars[seq(10,npar(AKr$fit.dmm),4)]
AKpars = pars[seq(10,npar(AKr$fit.dmm),4)]
pars[pars == AKpars]
pars[pars %in% AKpars]
any(pars %in% AKpars)
which(pars %in% AKpars)
pars %in% AKpars
AKr$fit.dmm@response
fit.dmm2@nresp
fit.dmm2@nstates
3 * 2
getpars(fit.dmm2)
AKpars = pars[seq(10,npar(AKr$fit.dmm),4)]
helper = function(x, y) { return(c(x, runif(y))) }
lapply(function(z) helper(z, 9), AKpars)
lapply(AKpars, function(z) helper(z,9))
unlist(lapply(AKpars, function(z) helper(z,9)))
length(unlist(lapply(AKpars, function(z) helper(z,9))))
source('betting-sequence-model.R')
source('betting-sequence-model.R')
source('working.R')
source('working.R')
source('working.R')
source('working.R')
ls()
source('working.R')
source('working.R')
source('betting-sequence-model.R')
source('working.R')
source('betting-sequence-model.R')
source('working.R')
source('betting-sequence-model.R')
source('working.R')
unlist(AKpars, lapply(function(z) helper(z,9)))
unlist(AKpars, lapply(function(z) helper(z,9)))
unlist(lapply(AKpars, function(z) helper(z,9)))
source('working.R')
source('working.R')
c(rep(1, skipnum), rep(1,224), rep(0, 224)))
c(rep(1, skipnum), rep(1,224), rep(0, 224))
length(c(rep(1, skipnum), rep(1,224), rep(0, 224)))
14*10
140*2
length(c(rep(1, skipnum), rep(1,224), rep(0, 224)))
source('working.R')
source('working.R')
source('working.R')
source('betting-sequence-model.R')
source('working.R')
reload()
library(depmixS4)
source('working.R')
source('working.R')
source('working.R')
source('working.R')
source('working.R')
source('working.R')
source('betting-sequence-model.R')
source('working.R')
source('betting-sequence-model.R')
source('working.R')
source('working.R')
ls()
AKf$eval.matrix
AKf$fit.dmm@response
responseinitsfinal
getpars(AKr$fit.dmm)
source('working.R')
source('working.R')
source('working.R')
source('working.R')
ls()
AKf$eval.matrix
AKf$fit.dmm@response
source('working.R')
hands= c('AKo', as.character(sample(unique(pdata$V2), 9)))
sort(hands)
sort(hands)
hands= c('AKo', as.character(sample(unique(pdata$V2), 9)))
sort(hands)
hands= c('AKo', as.character(sample(unique(pdata$V2), 9)))
sort(hands)
hands= c('AKo', as.character(sample(unique(pdata$V2), 9)))
sort(hands)
"AKo" %in% hands
hands %in% "AKo"
which("AKo" %in% hands)
hands == 'AKo'
'AKo' == hands
'AKo' == sort(hands)
which('AKo' %in% sort(hands))
which('AKo' == sort(hands))
length(hands)
source('working.R')
ls()
AKf$eval.matrix
length(hand)
length(hands)
length(idx)
idx
length(hand) - idx
length(hands) - idx
responseinitsfinal
runif(1)
c(rep(runif(1), idx-1), x, rep(runif(1), length(hands)-idx))
c(rep(runif(1), idx-1), 100.0, rep(runif(1), length(hands)-idx))
AKf$eval.matrix
AKf$eval.matrix$V2
sort(AKf$eval.matrix$V2)
AKf$eval.matrix
starttime = proc.time()
source('working.R'); proc.time() - starttime;
?proc.time
proc.time()
a = proc.time()
proc.time() - a
proc.time() - a
proc.time() - a
proc.time() - a
proc.time() - a
proc.time() - a
proc.time() - a
proc.time() - starttime
ls()
AKf$eval.matrix
getwd()
save.image()
savehistory()
